'use strict';

var app = angular.module('Meaniscule', ['ui.router', 'ngDragDrop']);

app.config(function ($urlRouterProvider, $locationProvider) {
   // This turns off hashbang urls (/#about) and changes it to something normal (/about)
   $locationProvider.html5Mode(true);
   // If we go to a URL that ui-router doesn't have registered, go to the "/" url.
   $urlRouterProvider.otherwise('/');
});
'use strict';

app.controller('ModulesController', function ($scope, $http, ModulesFactory) {

  $scope.$on('$stateChangeSuccess', function () {
    var defaultMessage = 'If you don\'t see a list of links here, you need to seed your database!\nIn your terminal, go to this app\'s directory and run `gulp seedDB`.\nThen try this page again.';

    ModulesFactory.getNodeModules().then(function (modules) {
      $scope.nodeModules = modules;

      if (!$scope.nodeModules.length) {
        $scope.defaultMessage = defaultMessage;
      }
    });
  });
});
'use strict';

app.factory('ModulesFactory', function ($http) {
  return {
    getNodeModules: function getNodeModules() {
      return $http.get('/api/modules/').then(function (res) {
        return res.data;
      });
    }
  };
});
'use strict';

app.config(function ($stateProvider) {
    $stateProvider.state('modules', {
        url: '/modules',
        templateUrl: '/app/modules/modules.html',
        controller: 'ModulesController'
    });
});
'use strict';

app.directive('fsadraggable', function ($document) {

	return {
		restrict: 'A',
		link: function link(scope, element, attrs) {
			var startX = 0,
			    startY = 0,
			    newX = 0,
			    newY = 0;

			scope.fsasetdata = 'fsasetdata' in attrs;
			if (!!scope.fsasetdata) {
				var data = attrs.fsasetdata;
				var JSONdata = JSON.stringify(data);
			}

			element.css({
				position: 'relative',
				cursor: 'pointer'
			});

			element[0].draggable = true;

			element.bind('dragstart', function (event) {
				startX = event.originalEvent.pageX - newX;
				startY = event.originalEvent.pageY - newY;
				if (data) {
					event.originalEvent.dataTransfer.setData('auto', JSONdata);
				}
			});

			element.bind('drag', function (event) {

				if (event.originalEvent.pageX === 0) {
					// If this isn't here, pageX will reset to 0 upon end of drag
					return;
				}

				newX = event.originalEvent.pageX - startX;
				newY = event.originalEvent.pageY - startY;
			});

			element.bind('dragend', function (event) {

				element.css({
					left: newX + 'px',
					top: newY + 'px'
				});
			});
		},
		scope: {
			fsadata: '@'
		}
	};
});

app.directive('fsaresizeable', ['$document', function ($document) {
	return {
		link: function link(scope, element, attrs) {
			var topBorder, leftBorder, rightBorder, bottomBorder;
			var borderWidth = 10;

			element.css({
				position: 'relative'
			});

			element.on('mousemove', function (event) {

				var topBorder = element[0].offsetTop;
				var leftBorder = element[0].offsetLeft;
				var rightBorder = element[0].offsetLeft + element[0].offsetWidth;
				var bottomBorder = element[0].offsetTop + element[0].offsetHeight;

				var onRightBorderCheck = event.pageX < rightBorder && event.pageX > rightBorder - borderWidth;
				var onBottomBorderCheck = event.pageY < bottomBorder && event.pageY > bottomBorder - borderWidth;

				if (onRightBorderCheck) {
					element.css({
						cursor: 'e-resize'
					});
				}

				if (onBottomBorderCheck) {
					element.css({
						cursor: 's-resize'
					});
				}

				if (onRightBorderCheck && onBottomBorderCheck) {
					element.css({
						cursor: 'se-resize'
					});
				}

				if (event.pageX < rightBorder - borderWidth && event.pageY < bottomBorder - borderWidth) {
					element.css({
						cursor: 'pointer'
					});
				}
			});

			element.on('mousedown', function (event) {
				event.preventDefault();

				var topBorder = element[0].offsetTop;
				var leftBorder = element[0].offsetLeft;
				var rightBorder = element[0].offsetLeft + element[0].offsetWidth;
				var bottomBorder = element[0].offsetTop + element[0].offsetHeight;

				var onRightBorderCheck = event.pageX < rightBorder && event.pageX > rightBorder - borderWidth;
				var onBottomBorderCheck = event.pageY < bottomBorder && event.pageY > bottomBorder - borderWidth;

				if (onRightBorderCheck || onBottomBorderCheck) {

					$document.on('mousemove', sizeMouseMove);
					$document.on('mouseup', sizeMouseUp);
				}
			});
			function sizeMouseMove() {
				var newHeight = event.pageY - element[0].offsetTop;
				var newWidth = event.pageX - element[0].offsetLeft;

				if (newHeight < borderWidth) {
					newHeight = borderWidth;
				}

				if (newWidth < borderWidth) {
					newWidth = borderWidth;
				}

				bottomBorder = event.pageY;
				rightBorder = event.pageX;
				element.css({
					height: newHeight + 'px',
					width: newWidth + 'px'
				});
			}

			function sizeMouseUp() {
				element[0].draggable = true;
				$document.off('mousemove', sizeMouseMove);
				$document.off('mouseup', sizeMouseUp);
			}
		}
	};
}]);

app.directive('fsacontainer', ['$document', function ($document) {
	return {
		link: function link(scope, element, attrs) {
			var data;

			scope.fsagetdata = 'fsagetdata' in attrs;
			if (!!scope.fsagetdata) {
				attrs.fsagetdata = [];
			}

			element.bind('dragover', function (event) {
				event.preventDefault();
			});

			element.bind('drop', function (event) {
				console.log(event.originalEvent.target);
				if (event.originalEvent.dataTransfer.getData('auto') === '') {
					return;
				}
				data = JSON.parse(JSON.parse(event.originalEvent.dataTransfer.getData('auto')));

				if (!!scope.fsagetdata) {
					attrs.fsagetdata.push(data);
				}
			});

			scope.fsasnap = 'fsasnap' in attrs;
			if (!!scope.fsasnap) {
				console.log();
			}

			scope.fsaclone = 'fsaclone' in attrs;
			if (!!scope.fsasnap) {}
		}
	};
}]);
// cursor: 'pointer'
'use strict';

app.controller('HomeController', function ($scope, $timeout, $http) {

  $scope.msgFromScope = '...And I\'m a message from the HomeController scope, just so you know that I work!';

  $scope.controllerdata = {
    test: 'test object from home controller'
  };
});

app.controller('secondController', function ($scope, $timeout, $http, $attrs) {

  $scope.logdata = function () {
    console.log('from the second controller', $attrs.fsagetdata);
  };
  var myReceivedData = $attrs.fsacontainer;
});
'use strict';

app.config(function ($stateProvider) {
    $stateProvider.state('home', {
        url: '/',
        templateUrl: '/app/home/home.html',
        controller: 'HomeController'
    });
});
"use strict";

app.directive("navbar", function () {
	return {
		restrict: "E",
		templateUrl: "/app/navbar/navbar.html"
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIm1vZHVsZXMvbW9kdWxlcy5jb250cm9sbGVyLmpzIiwibW9kdWxlcy9tb2R1bGVzLmZhY3RvcnkuanMiLCJtb2R1bGVzL21vZHVsZXMuc3RhdGUuanMiLCJob21lL2RyYWdkaXJlY3RpdmUuanMiLCJob21lL2hvbWUuY29udHJvbGxlci5qcyIsImhvbWUvaG9tZS5zdGF0ZS5qcyIsIm5hdmJhci9uYXZiYXIuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxXQUFXLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQzs7QUFFcEUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLGtCQUFrQixFQUFFLGlCQUFpQixFQUFFOztBQUV6RCxvQkFBaUIsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7O0FBRWxDLHFCQUFrQixDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztDQUNwQyxDQUFDLENBQUM7OztBQ1BILEdBQUcsQ0FBQyxVQUFVLENBQUMsbUJBQW1CLEVBQUUsVUFBUyxNQUFNLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRTs7QUFFMUUsUUFBTSxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSxZQUFZO0FBQzVDLFFBQUksY0FBYyxHQUFHLDBLQUEwSyxDQUFDOztBQUVoTSxrQkFBYyxDQUFDLGNBQWMsRUFBRSxDQUM1QixJQUFJLENBQUMsVUFBUyxPQUFPLEVBQUU7QUFDdEIsWUFBTSxDQUFDLFdBQVcsR0FBRyxPQUFPLENBQUM7O0FBRTdCLFVBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRTtBQUM5QixjQUFNLENBQUMsY0FBYyxHQUFHLGNBQWMsQ0FBQztPQUN4QztLQUNGLENBQUMsQ0FBQztHQUNOLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQzs7O0FDZEgsR0FBRyxDQUFDLE9BQU8sQ0FBQyxn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RSxFQUVwQjtHQUVSO0VBQ0QsQ0FBQTtDQUNELENBQUMsQ0FBQyxDQUFBOzs7O0FDM0xILEdBQUcsQ0FBQyxVQUFVLENBQUMsZ0JBQWdCLEVBQUUsVUFBUyxNQUFNLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRTs7QUFFakUsUUFBTSxDQUFDLFlBQVksR0FBRyxvRkFBbUYsQ0FBQzs7QUFFMUcsUUFBTSxDQUFDLGNBQWMsR0FBRztBQUN0QixRQUFJLEVBQUUsa0NBQWtDO0dBQ3pDLENBQUE7Q0FFRixDQUFDLENBQUM7O0FBRUgsR0FBRyxDQUFDLFVBQVUsQ0FBQyxrQkFBa0IsRUFBRSxVQUFVLE1BQU0sRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRTs7QUFFNUUsUUFBTSxDQUFDLE9BQU8sR0FBRyxZQUFZO0FBQzNCLFdBQU8sQ0FBQyxHQUFHLENBQUMsNEJBQTRCLEVBQUUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFBO0dBQzdELENBQUE7QUFDRCxNQUFJLGNBQWMsR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFBO0NBRXpDLENBQUMsQ0FBQTs7O0FDakJGLEdBQUcsQ0FBQyxNQUFNLENBQUMsVUFBVSxjQUFjLEVBQUU7QUFDakMsa0JBQWMsQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFO0FBQ3pCLFdBQUcsRUFBRSxHQUFHO0FBQ1IsbUJBQVcsRUFBRSxxQkFBcUI7QUFDbEMsa0JBQVUsRUFBRSxnQkFBZ0I7S0FDL0IsQ0FBQyxDQUFDO0NBQ04sQ0FBQyxDQUFDOzs7QUNOSCxHQUFHLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxZQUFVO0FBQ2pDLFFBQU87QUFDTixVQUFRLEVBQUUsR0FBRztBQUNiLGFBQVcsRUFBRSx5QkFBeUI7RUFDdEMsQ0FBQztDQUNGLENBQUMsQ0FBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdNZWFuaXNjdWxlJywgWyd1aS5yb3V0ZXInLCAnbmdEcmFnRHJvcCddKTtcblxuYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHVybFJvdXRlclByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgLy8gVGhpcyB0dXJucyBvZmYgaGFzaGJhbmcgdXJscyAoLyNhYm91dCkgYW5kIGNoYW5nZXMgaXQgdG8gc29tZXRoaW5nIG5vcm1hbCAoL2Fib3V0KVxuICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuICAgLy8gSWYgd2UgZ28gdG8gYSBVUkwgdGhhdCB1aS1yb3V0ZXIgZG9lc24ndCBoYXZlIHJlZ2lzdGVyZWQsIGdvIHRvIHRoZSBcIi9cIiB1cmwuXG4gICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG59KTsiLCJhcHAuY29udHJvbGxlcignTW9kdWxlc0NvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBNb2R1bGVzRmFjdG9yeSkge1xuICBcbiAgJHNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGVmYXVsdE1lc3NhZ2UgPSAnSWYgeW91IGRvblxcJ3Qgc2VlIGEgbGlzdCBvZiBsaW5rcyBoZXJlLCB5b3UgbmVlZCB0byBzZWVkIHlvdXIgZGF0YWJhc2UhXFxuSW4geW91ciB0ZXJtaW5hbCwgZ28gdG8gdGhpcyBhcHBcXCdzIGRpcmVjdG9yeSBhbmQgcnVuIGBndWxwIHNlZWREQmAuXFxuVGhlbiB0cnkgdGhpcyBwYWdlIGFnYWluLic7XG5cbiAgICBNb2R1bGVzRmFjdG9yeS5nZXROb2RlTW9kdWxlcygpXG4gICAgICAudGhlbihmdW5jdGlvbihtb2R1bGVzKSB7XG4gICAgICAgICRzY29wZS5ub2RlTW9kdWxlcyA9IG1vZHVsZXM7XG4gICAgICAgIFxuICAgICAgICBpZiAoISRzY29wZS5ub2RlTW9kdWxlcy5sZW5ndGgpIHtcbiAgICAgICAgICAkc2NvcGUuZGVmYXVsdE1lc3NhZ2UgPSBkZWZhdWx0TWVzc2FnZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH0pO1xufSk7IiwiYXBwLmZhY3RvcnkoJ01vZHVsZXNGYWN0b3J5JywgZnVuY3Rpb24oJGh0dHApIHtcbiAgcmV0dXJuIHtcbiAgICBnZXROb2RlTW9kdWxlczogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL21vZHVsZXMvJylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5kYXRhO1xuICAgICAgICB9KTsgICAgXG4gICAgfVxuICB9O1xufSk7IiwiYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnbW9kdWxlcycsIHtcbiAgICAgICAgdXJsOiAnL21vZHVsZXMnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJy9hcHAvbW9kdWxlcy9tb2R1bGVzLmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyOiAnTW9kdWxlc0NvbnRyb2xsZXInXG4gICAgfSk7XG59KTsiLCJhcHAuZGlyZWN0aXZlKCdmc2FkcmFnZ2FibGUnLCBmdW5jdGlvbiAoJGRvY3VtZW50KSB7XG5cblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdDogJ0EnLFxuXHRcdGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblx0XHRcdHZhciBzdGFydFggPSAwLCBzdGFydFkgPSAwLCBuZXdYID0gMCwgbmV3WSA9IDBcblxuXHRcdFx0c2NvcGUuZnNhc2V0ZGF0YSA9ICdmc2FzZXRkYXRhJyBpbiBhdHRyc1xuXHRcdFx0aWYgKCEhc2NvcGUuZnNhc2V0ZGF0YSkge1xuXHRcdFx0XHR2YXIgZGF0YSA9IGF0dHJzLmZzYXNldGRhdGFcblx0XHRcdFx0dmFyIEpTT05kYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YSlcblx0XHRcdH1cblxuXHRcdFx0ZWxlbWVudC5jc3Moe1xuXHRcdFx0XHRwb3NpdGlvbjogJ3JlbGF0aXZlJyxcblx0XHRcdFx0Y3Vyc29yOiAncG9pbnRlcidcblx0XHRcdH0pXG5cblx0XHRcdGVsZW1lbnRbMF0uZHJhZ2dhYmxlID0gdHJ1ZVxuXG5cdFx0XHRlbGVtZW50LmJpbmQoJ2RyYWdzdGFydCcsIGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0XHRzdGFydFggPSBldmVudC5vcmlnaW5hbEV2ZW50LnBhZ2VYIC0gbmV3WFxuXHRcdFx0XHRzdGFydFkgPSBldmVudC5vcmlnaW5hbEV2ZW50LnBhZ2VZIC0gbmV3WVxuXHRcdFx0XHRpZiAoZGF0YSkge1xuXHRcdFx0XHRcdGV2ZW50Lm9yaWdpbmFsRXZlbnQuZGF0YVRyYW5zZmVyLnNldERhdGEoJ2F1dG8nLCBKU09OZGF0YSlcblx0XHRcdFx0fVxuXHRcdFx0fSlcblxuXHRcdFx0ZWxlbWVudC5iaW5kKCdkcmFnJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cblx0XHRcdFx0aWYgKGV2ZW50Lm9yaWdpbmFsRXZlbnQucGFnZVggPT09IDApIHtcblx0XHRcdFx0XHQvLyBJZiB0aGlzIGlzbid0IGhlcmUsIHBhZ2VYIHdpbGwgcmVzZXQgdG8gMCB1cG9uIGVuZCBvZiBkcmFnXG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRuZXdYID0gZXZlbnQub3JpZ2luYWxFdmVudC5wYWdlWCAtIHN0YXJ0WFxuXHRcdFx0XHRuZXdZID0gZXZlbnQub3JpZ2luYWxFdmVudC5wYWdlWSAtIHN0YXJ0WVxuXHRcdFx0fSlcblxuXHRcdFx0ZWxlbWVudC5iaW5kKCdkcmFnZW5kJywgZnVuY3Rpb24gKGV2ZW50KXtcblx0XHRcdFx0XG5cdFx0XHRcdGVsZW1lbnQuY3NzKHtcblx0XHRcdFx0XHRsZWZ0OiBuZXdYICsgJ3B4Jyxcblx0XHRcdFx0XHR0b3A6IG5ld1kgKyAncHgnXG5cdFx0XHRcdH0pXG5cdFx0XHR9KVxuXHRcdH0sXG5cdFx0c2NvcGU6IHtcblx0XHRcdGZzYWRhdGE6ICdAJ1xuXHRcdH1cblx0fVxuXG59KVxuXG5hcHAuZGlyZWN0aXZlKCdmc2FyZXNpemVhYmxlJywgWyckZG9jdW1lbnQnLCBmdW5jdGlvbiAoJGRvY3VtZW50KSB7XG5cdHJldHVybiB7XG5cdFx0bGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuXHRcdFx0dmFyIHRvcEJvcmRlciwgbGVmdEJvcmRlciwgcmlnaHRCb3JkZXIsIGJvdHRvbUJvcmRlclxuXHRcdFx0dmFyIGJvcmRlcldpZHRoID0gMTBcblxuXHRcdFx0ZWxlbWVudC5jc3Moe1xuXHRcdFx0XHRwb3NpdGlvbjogJ3JlbGF0aXZlJyxcblx0XHRcdFx0Ly8gY3Vyc29yOiAncG9pbnRlcidcblx0XHRcdH0pXG5cblx0XHRcdGVsZW1lbnQub24oJ21vdXNlbW92ZScsIGZ1bmN0aW9uIChldmVudCkge1xuXG5cdFx0XHRcdHZhciB0b3BCb3JkZXIgPSBlbGVtZW50WzBdLm9mZnNldFRvcFxuXHRcdFx0XHR2YXIgbGVmdEJvcmRlciA9IGVsZW1lbnRbMF0ub2Zmc2V0TGVmdFxuXHRcdFx0XHR2YXIgcmlnaHRCb3JkZXIgPSBlbGVtZW50WzBdLm9mZnNldExlZnQgKyBlbGVtZW50WzBdLm9mZnNldFdpZHRoXG5cdFx0XHRcdHZhciBib3R0b21Cb3JkZXIgPSBlbGVtZW50WzBdLm9mZnNldFRvcCArIGVsZW1lbnRbMF0ub2Zmc2V0SGVpZ2h0XG5cblx0XHRcdFx0dmFyIG9uUmlnaHRCb3JkZXJDaGVjayA9IGV2ZW50LnBhZ2VYIDwgcmlnaHRCb3JkZXIgJiYgZXZlbnQucGFnZVggPiByaWdodEJvcmRlciAtIGJvcmRlcldpZHRoXG5cdFx0XHRcdHZhciBvbkJvdHRvbUJvcmRlckNoZWNrID0gZXZlbnQucGFnZVkgPCBib3R0b21Cb3JkZXIgJiYgZXZlbnQucGFnZVkgPiBib3R0b21Cb3JkZXIgLSBib3JkZXJXaWR0aFxuXG5cblx0XHRcdFx0aWYgKG9uUmlnaHRCb3JkZXJDaGVjaykge1xuXHRcdFx0XHRcdGVsZW1lbnQuY3NzKHtcblx0XHRcdFx0XHRcdGN1cnNvcjogJ2UtcmVzaXplJ1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAob25Cb3R0b21Cb3JkZXJDaGVjaykge1xuXHRcdFx0XHRcdGVsZW1lbnQuY3NzKHtcblx0XHRcdFx0XHRcdGN1cnNvcjogJ3MtcmVzaXplJ1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAob25SaWdodEJvcmRlckNoZWNrICYmIG9uQm90dG9tQm9yZGVyQ2hlY2spIHtcblx0XHRcdFx0XHRlbGVtZW50LmNzcyh7XG5cdFx0XHRcdFx0XHRjdXJzb3I6ICdzZS1yZXNpemUnXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChldmVudC5wYWdlWCA8IHJpZ2h0Qm9yZGVyIC0gYm9yZGVyV2lkdGggJiYgZXZlbnQucGFnZVkgPCBib3R0b21Cb3JkZXIgLSBib3JkZXJXaWR0aCkge1xuXHRcdFx0XHRcdGVsZW1lbnQuY3NzKHtcblx0XHRcdFx0XHRcdGN1cnNvcjogJ3BvaW50ZXInXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fVxuXHRcdFx0fSlcblxuXG5cdFx0XHRlbGVtZW50Lm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKVxuXHRcdFx0XHRcblx0XHRcdFx0dmFyIHRvcEJvcmRlciA9IGVsZW1lbnRbMF0ub2Zmc2V0VG9wXG5cdFx0XHRcdHZhciBsZWZ0Qm9yZGVyID0gZWxlbWVudFswXS5vZmZzZXRMZWZ0XG5cdFx0XHRcdHZhciByaWdodEJvcmRlciA9IGVsZW1lbnRbMF0ub2Zmc2V0TGVmdCArIGVsZW1lbnRbMF0ub2Zmc2V0V2lkdGhcblx0XHRcdFx0dmFyIGJvdHRvbUJvcmRlciA9IGVsZW1lbnRbMF0ub2Zmc2V0VG9wICsgZWxlbWVudFswXS5vZmZzZXRIZWlnaHRcblxuXHRcdFx0XHR2YXIgb25SaWdodEJvcmRlckNoZWNrID0gZXZlbnQucGFnZVggPCByaWdodEJvcmRlciAmJiBldmVudC5wYWdlWCA+IHJpZ2h0Qm9yZGVyIC0gYm9yZGVyV2lkdGhcblx0XHRcdFx0dmFyIG9uQm90dG9tQm9yZGVyQ2hlY2sgPSBldmVudC5wYWdlWSA8IGJvdHRvbUJvcmRlciAmJiBldmVudC5wYWdlWSA+IGJvdHRvbUJvcmRlciAtIGJvcmRlcldpZHRoXG5cblx0XHRcdFx0aWYgKG9uUmlnaHRCb3JkZXJDaGVjayB8fCBvbkJvdHRvbUJvcmRlckNoZWNrKSB7XG5cblx0XHRcdFx0XHQkZG9jdW1lbnQub24oJ21vdXNlbW92ZScsIHNpemVNb3VzZU1vdmUpXG5cdFx0XHRcdFx0JGRvY3VtZW50Lm9uKCdtb3VzZXVwJywgc2l6ZU1vdXNlVXApXG5cdFx0XHRcdH1cdFx0XHRcdFxuXHRcdFx0fSlcblx0XHRcdGZ1bmN0aW9uIHNpemVNb3VzZU1vdmUgKCkge1xuXHRcdFx0XHR2YXIgbmV3SGVpZ2h0ID0gZXZlbnQucGFnZVkgLSBlbGVtZW50WzBdLm9mZnNldFRvcFxuXHRcdFx0XHR2YXIgbmV3V2lkdGggPSBldmVudC5wYWdlWCAtIGVsZW1lbnRbMF0ub2Zmc2V0TGVmdFxuXG5cdFx0XHRcdGlmIChuZXdIZWlnaHQgPCBib3JkZXJXaWR0aCkge1xuXHRcdFx0XHRcdG5ld0hlaWdodCA9IGJvcmRlcldpZHRoXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAobmV3V2lkdGggPCBib3JkZXJXaWR0aCkge1xuXHRcdFx0XHRcdG5ld1dpZHRoID0gYm9yZGVyV2lkdGhcblx0XHRcdFx0fVxuXHRcdFx0XHQgXG5cdFx0XHRcdGJvdHRvbUJvcmRlciA9IGV2ZW50LnBhZ2VZXG5cdFx0XHRcdHJpZ2h0Qm9yZGVyID0gZXZlbnQucGFnZVhcblx0XHRcdFx0ZWxlbWVudC5jc3Moe1xuXHRcdFx0XHRcdGhlaWdodDogbmV3SGVpZ2h0ICsgJ3B4Jyxcblx0XHRcdFx0XHR3aWR0aDogbmV3V2lkdGggKyAncHgnXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cblx0XHRcdGZ1bmN0aW9uIHNpemVNb3VzZVVwICgpIHtcblx0XHRcdFx0ZWxlbWVudFswXS5kcmFnZ2FibGUgPSB0cnVlXG5cdFx0XHRcdCRkb2N1bWVudC5vZmYoJ21vdXNlbW92ZScsIHNpemVNb3VzZU1vdmUpXG5cdFx0XHRcdCRkb2N1bWVudC5vZmYoJ21vdXNldXAnLCBzaXplTW91c2VVcCk7XG5cdFx0XHR9XG5cblx0XHR9XG5cdH1cbn1dKVxuXG5hcHAuZGlyZWN0aXZlKCdmc2Fjb250YWluZXInLCBbJyRkb2N1bWVudCcsIGZ1bmN0aW9uICgkZG9jdW1lbnQpIHtcblx0cmV0dXJuIHtcblx0XHRsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG5cdFx0XHR2YXIgZGF0YVxuXG5cdFx0XHRzY29wZS5mc2FnZXRkYXRhID0gJ2ZzYWdldGRhdGEnIGluIGF0dHJzXG5cdFx0XHRpZiAoISFzY29wZS5mc2FnZXRkYXRhKSB7XG5cdFx0XHRcdGF0dHJzLmZzYWdldGRhdGEgPSBbXVxuXHRcdFx0fSAgICAgICAgIFx0XG5cblx0XHRcdGVsZW1lbnQuYmluZCgnZHJhZ292ZXInLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgXHR9KTtcblxuICAgICAgICAgXHRlbGVtZW50LmJpbmQoJ2Ryb3AnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgIFx0XHRjb25zb2xlLmxvZyhldmVudC5vcmlnaW5hbEV2ZW50LnRhcmdldClcbiAgICAgICAgIFx0XHRpZiAoZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhVHJhbnNmZXIuZ2V0RGF0YShcImF1dG9cIikgPT09ICcnKSB7XG4gICAgICAgICBcdFx0XHRyZXR1cm4gXG4gICAgICAgICBcdFx0fSAgICAgICAgIFx0XHRcbiAgICAgICAgIFx0XHRkYXRhID0gSlNPTi5wYXJzZShKU09OLnBhcnNlKGV2ZW50Lm9yaWdpbmFsRXZlbnQuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJhdXRvXCIpKSlcbiAgICAgICAgIFx0XHRcbiAgICAgICAgIFx0XHRpZiAoISFzY29wZS5mc2FnZXRkYXRhKSB7XG5cdFx0XHRcdFx0YXR0cnMuZnNhZ2V0ZGF0YS5wdXNoKGRhdGEpXG5cdFx0XHRcdH1cdFxuICAgICAgICAgXHR9KVxuXG4gICAgICAgICBcdHNjb3BlLmZzYXNuYXAgPSAnZnNhc25hcCcgaW4gYXR0cnNcbiAgICAgICAgIFx0aWYgKCEhc2NvcGUuZnNhc25hcCkge1xuICAgICAgICAgXHRcdGNvbnNvbGUubG9nKClcbiAgICAgICAgIFx0fVxuXG4gICAgICAgICBcdHNjb3BlLmZzYWNsb25lID0gJ2ZzYWNsb25lJyBpbiBhdHRyc1xuICAgICAgICAgXHRpZiAoISFzY29wZS5mc2FzbmFwKSB7XG5cbiAgICAgICAgIFx0fVxuXG5cdFx0fVxuXHR9XG59XSlcbiIsImFwcC5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJHRpbWVvdXQsICRodHRwKSB7XG4gIFxuICAkc2NvcGUubXNnRnJvbVNjb3BlID0gXCIuLi5BbmQgSSdtIGEgbWVzc2FnZSBmcm9tIHRoZSBIb21lQ29udHJvbGxlciBzY29wZSwganVzdCBzbyB5b3Uga25vdyB0aGF0IEkgd29yayFcIjtcblxuICAkc2NvcGUuY29udHJvbGxlcmRhdGEgPSB7XG4gICAgdGVzdDogJ3Rlc3Qgb2JqZWN0IGZyb20gaG9tZSBjb250cm9sbGVyJ1xuICB9XG5cbn0pO1xuXG5hcHAuY29udHJvbGxlcignc2Vjb25kQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICR0aW1lb3V0LCAkaHR0cCwgJGF0dHJzKSB7XG5cbiAgJHNjb3BlLmxvZ2RhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29uc29sZS5sb2coJ2Zyb20gdGhlIHNlY29uZCBjb250cm9sbGVyJywgJGF0dHJzLmZzYWdldGRhdGEpXG4gIH1cbiAgdmFyIG15UmVjZWl2ZWREYXRhID0gJGF0dHJzLmZzYWNvbnRhaW5lclxuICBcbn0pIiwiYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgdXJsOiAnLycsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9ob21lL2hvbWUuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcidcbiAgICB9KTtcbn0pOyIsImFwcC5kaXJlY3RpdmUoXCJuYXZiYXJcIiwgZnVuY3Rpb24oKXtcblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdDogXCJFXCIsXG5cdFx0dGVtcGxhdGVVcmw6IFwiL2FwcC9uYXZiYXIvbmF2YmFyLmh0bWxcIlxuXHR9O1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9