'use strict';

var app = angular.module('Meaniscule', ['ui.router', 'ngDragDrop']);

app.config(function ($urlRouterProvider, $locationProvider) {
   // This turns off hashbang urls (/#about) and changes it to something normal (/about)
   $locationProvider.html5Mode(true);
   // If we go to a URL that ui-router doesn't have registered, go to the "/" url.
   $urlRouterProvider.otherwise('/');
});
'use strict';

app.directive('fsadraggable', function ($document) {

	return {
		restrict: 'A',
		link: function link(scope, element, attrs) {
			var startX = 0,
			    startY = 0,
			    newX = 0,
			    newY = 0;

			scope.fsasetdata = 'fsasetdata' in attrs;
			if (!!scope.fsasetdata) {
				var data = attrs.fsasetdata;
				var JSONdata = JSON.stringify(data);
			}

			element.css({
				position: 'relative',
				cursor: 'pointer'
			});

			element[0].draggable = true;

			element.bind('dragstart', function (event) {
				startX = event.originalEvent.pageX - newX;
				startY = event.originalEvent.pageY - newY;
				if (data) {
					event.originalEvent.dataTransfer.setData('auto', JSONdata);
				}
			});

			element.bind('drag', function (event) {

				if (event.originalEvent.pageX === 0) {
					// If this isn't here, pageX will reset to 0 upon end of drag
					return;
				}

				newX = event.originalEvent.pageX - startX;
				newY = event.originalEvent.pageY - startY;
			});

			element.bind('dragend', function (event) {

				element.css({
					left: newX + 'px',
					top: newY + 'px'
				});
			});
		},
		scope: {
			fsadata: '@'
		}
	};
});

app.directive('fsaresizeable', ['$document', function ($document) {
	return {
		link: function link(scope, element, attrs) {
			var topBorder, leftBorder, rightBorder, bottomBorder;
			var borderWidth = 10;

			element.css({
				position: 'relative'
			});

			element.on('mousemove', function (event) {

				var topBorder = element[0].offsetTop;
				var leftBorder = element[0].offsetLeft;
				var rightBorder = element[0].offsetLeft + element[0].offsetWidth;
				var bottomBorder = element[0].offsetTop + element[0].offsetHeight;

				var onRightBorderCheck = event.pageX < rightBorder && event.pageX > rightBorder - borderWidth;
				var onBottomBorderCheck = event.pageY < bottomBorder && event.pageY > bottomBorder - borderWidth;

				if (onRightBorderCheck) {
					element.css({
						cursor: 'e-resize'
					});
				} else if (onBottomBorderCheck) {
					element.css({
						cursor: 's-resize'
					});
				}

				if (onRightBorderCheck && onBottomBorderCheck) {
					element.css({
						cursor: 'se-resize'
					});
				}

				if (event.pageX < rightBorder - borderWidth && event.pageY < bottomBorder - borderWidth) {
					element.css({
						cursor: 'pointer'
					});
				}
			});

			element.on('mousedown', function (event) {
				// event.preventDefault()
				// element[0].draggable = false

				var topBorder = element[0].offsetTop;
				var leftBorder = element[0].offsetLeft;
				var rightBorder = element[0].offsetLeft + element[0].offsetWidth;
				var bottomBorder = element[0].offsetTop + element[0].offsetHeight;

				var onRightBorderCheck = event.pageX < rightBorder && event.pageX > rightBorder - borderWidth;
				var onBottomBorderCheck = event.pageY < bottomBorder && event.pageY > bottomBorder - borderWidth;

				if (onRightBorderCheck && onBottomBorderCheck) {
					element[0].draggable = false;
					$document.on('mousemove', adjustWidthHeight);
					$document.on('mouseup', adjustMouseUp);
				}

				if (onRightBorderCheck) {
					element[0].draggable = false;
					$document.on('mousemove', adjustWidth);
					$document.on('mouseup', adjustMouseUp);
				}

				if (onBottomBorderCheck) {
					element[0].draggable = false;
					$document.on('mousemove', adjustHeight);
					$document.on('mouseup', adjustMouseUp);
				}
			});

			element.on('mouseup', function (event) {
				// event.preventDefault()
				element[0].draggable = true;
			});

			function adjustHeight() {
				var newHeight = event.pageY - element[0].offsetTop;

				if (newHeight < borderWidth) {
					newHeight = borderWidth;
				}

				bottomBorder = event.pageY;

				element.css({
					height: newHeight + 'px'
				});
			}

			function adjustWidth() {
				var newWidth = event.pageX - element[0].offsetLeft;

				if (newWidth < borderWidth) {
					newWidth = borderWidth;
				}

				rightBorder = event.pageX;

				element.css({
					width: newWidth + 'px'
				});
			}

			function adjustWidthHeight() {
				var newHeight = event.pageY - element[0].offsetTop;
				var newWidth = event.pageX - element[0].offsetLeft;

				if (newHeight < borderWidth) {
					newHeight = borderWidth;
				}

				if (newWidth < borderWidth) {
					newWidth = borderWidth;
				}

				bottomBorder = event.pageY;
				rightBorder = event.pageX;
				element.css({
					height: newHeight + 'px',
					width: newWidth + 'px'
				});
			}

			function adjustMouseUp() {
				element[0].draggable = true;
				$document.off('mousemove', adjustWidthHeight);
				$document.off('mousemove', adjustWidth);
				$document.off('mousemove', adjustHeight);
				$document.off('mouseup', adjustMouseUp);
			}
		}
	};
}]);

app.directive('fsacontainer', ['$document', function ($document) {
	return {
		link: function link(scope, element, attrs) {
			var data;

			scope.fsagetdata = 'fsagetdata' in attrs;
			if (!!scope.fsagetdata) {
				attrs.fsagetdata = [];
			}

			element.bind('dragover', function (event) {
				event.preventDefault();
			});

			element.bind('drop', function (event) {
				console.log(event.originalEvent.target);
				if (event.originalEvent.dataTransfer.getData('auto') === '') {
					return;
				}
				data = JSON.parse(JSON.parse(event.originalEvent.dataTransfer.getData('auto')));

				if (!!scope.fsagetdata) {
					attrs.fsagetdata.push(data);
				}
			});
		}
	};
}]);
// cursor: 'pointer'
'use strict';

app.controller('HomeController', function ($scope, $timeout, $http) {

  $scope.msgFromScope = '...And I\'m a message from the HomeController scope, just so you know that I work!';

  $scope.controllerdata = {
    test: 'test object from home controller'
  };
});

app.controller('secondController', function ($scope, $timeout, $http, $attrs) {

  $scope.logdata = function () {
    console.log('from the second controller', $attrs.fsagetdata);
  };
  var myReceivedData = $attrs.fsacontainer;
});
'use strict';

app.config(function ($stateProvider) {
    $stateProvider.state('home', {
        url: '/',
        templateUrl: '/app/home/home.html',
        controller: 'HomeController'
    });
});
'use strict';

app.controller('ModulesController', function ($scope, $http, ModulesFactory) {

  $scope.$on('$stateChangeSuccess', function () {
    var defaultMessage = 'If you don\'t see a list of links here, you need to seed your database!\nIn your terminal, go to this app\'s directory and run `gulp seedDB`.\nThen try this page again.';

    ModulesFactory.getNodeModules().then(function (modules) {
      $scope.nodeModules = modules;

      if (!$scope.nodeModules.length) {
        $scope.defaultMessage = defaultMessage;
      }
    });
  });
});
'use strict';

app.factory('ModulesFactory', function ($http) {
  return {
    getNodeModules: function getNodeModules() {
      return $http.get('/api/modules/').then(function (res) {
        return res.data;
      });
    }
  };
});
'use strict';

app.config(function ($stateProvider) {
    $stateProvider.state('modules', {
        url: '/modules',
        templateUrl: '/app/modules/modules.html',
        controller: 'ModulesController'
    });
});
"use strict";

app.directive("navbar", function () {
	return {
		restrict: "E",
		templateUrl: "/app/navbar/navbar.html"
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhvbWUvZHJhZ2RpcmVjdGl2ZS5qcyIsImhvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwiaG9tZS9ob21lLnN0YXRlLmpzIiwibW9kdWxlcy9tb2R1bGVzLmNvbnRyb2xsZXIuanMiLCJtb2R1bGVzL21vZHVsZXMuZmFjdG9yeS5qcyIsIm1vZHVsZXMvbW9kdWxlcy5zdGF0ZS5qcyIsIm5hdmJhci9uYXZiYXIuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxXQUFXLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQzs7QUFFcEUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLGtCQUFrQixFQUFFLGlCQUFpQixFQUFFOztBQUV6RCxvQkFBaUIsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7O0FBRWxDLHFCQUFrQixDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztDQUNwQyxDQUFDLENBQUM7OztBQ1BILEdBQUcsQ0FBQyxTQUFTLENBQUMsY0FBYyxFQUFFLFVBQVUsU0FBUyxFQUFFOztBQUVsRCxRQUFPO0FBQ04sVUFBUSxFQUFFLEdBQUc7QUFDYixNQUFJLEVBQUUsY0FBVSxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRTtBQUN0QyxPQUFJLE1BQU0sR0FBRyxDQUFDO09BQUUsTUFBTSxHQUFHLENBQUM7T0FBRSxJQUFJLEdBQUcsQ0FBQztPQUFFLElBQUksR0FBRyxDQUFDLENBQUE7O0FBRTlDLFFBQUssQ0FBQyxVQUFVLEdBQUcsWUFBWSxJQUFJLEtBQUssQ0FBQTtBQUN4QyxPQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFFO0FBQ3ZCLFFBQUksSUFBSSxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUE7QUFDM0IsUUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FB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QyxHQUFHLENBQUMscUJBQXFCLEVBQUUsWUFBWTtBQUM1QyxRQUFJLGNBQWMsR0FBRywwS0FBMEssQ0FBQzs7QUFFaE0sa0JBQWMsQ0FBQyxjQUFjLEVBQUUsQ0FDNUIsSUFBSSxDQUFDLFVBQVMsT0FBTyxFQUFFO0FBQ3RCLFlBQU0sQ0FBQyxXQUFXLEdBQUcsT0FBTyxDQUFDOztBQUU3QixVQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUU7QUFDOUIsY0FBTSxDQUFDLGNBQWMsR0FBRyxjQUFjLENBQUM7T0FDeEM7S0FDRixDQUFDLENBQUM7R0FDTixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUM7OztBQ2RILEdBQUcsQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLEVBQUUsVUFBUyxLQUFLLEVBQUU7QUFDNUMsU0FBTztBQUNMLGtCQUFjLEVBQUUsMEJBQVc7QUFDekIsYUFBTyxLQUFLLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxDQUM5QixJQUFJLENBQUMsVUFBUyxHQUFHLEVBQUU7QUFDbEIsZUFBTyxHQUFHLENBQUMsSUFBSSxDQUFDO09BQ2pCLENBQUMsQ0FBQztLQUNOO0dBQ0YsQ0FBQztDQUNILENBQUMsQ0FBQzs7O0FDVEgsR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLGNBQWMsRUFBRTtBQUNqQyxrQkFBYyxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUU7QUFDNUIsV0FBRyxFQUFFLFVBQVU7QUFDZixtQkFBVyxFQUFFLDJCQUEyQjtBQUN4QyxrQkFBVSxFQUFFLG1CQUFtQjtLQUNsQyxDQUFDLENBQUM7Q0FDTixDQUFDLENBQUM7OztBQ05ILEdBQUcsQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLFlBQVU7QUFDakMsUUFBTztBQUNOLFVBQVEsRUFBRSxHQUFHO0FBQ2IsYUFBVyxFQUFFLHlCQUF5QjtFQUN0QyxDQUFDO0NBQ0YsQ0FBQyxDQUFDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ01lYW5pc2N1bGUnLCBbJ3VpLnJvdXRlcicsICduZ0RyYWdEcm9wJ10pO1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uICgkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAvLyBUaGlzIHR1cm5zIG9mZiBoYXNoYmFuZyB1cmxzICgvI2Fib3V0KSBhbmQgY2hhbmdlcyBpdCB0byBzb21ldGhpbmcgbm9ybWFsICgvYWJvdXQpXG4gICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gICAvLyBJZiB3ZSBnbyB0byBhIFVSTCB0aGF0IHVpLXJvdXRlciBkb2Vzbid0IGhhdmUgcmVnaXN0ZXJlZCwgZ28gdG8gdGhlIFwiL1wiIHVybC5cbiAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbn0pOyIsImFwcC5kaXJlY3RpdmUoJ2ZzYWRyYWdnYWJsZScsIGZ1bmN0aW9uICgkZG9jdW1lbnQpIHtcblxuXHRyZXR1cm4ge1xuXHRcdHJlc3RyaWN0OiAnQScsXG5cdFx0bGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuXHRcdFx0dmFyIHN0YXJ0WCA9IDAsIHN0YXJ0WSA9IDAsIG5ld1ggPSAwLCBuZXdZID0gMFxuXG5cdFx0XHRzY29wZS5mc2FzZXRkYXRhID0gJ2ZzYXNldGRhdGEnIGluIGF0dHJzXG5cdFx0XHRpZiAoISFzY29wZS5mc2FzZXRkYXRhKSB7XG5cdFx0XHRcdHZhciBkYXRhID0gYXR0cnMuZnNhc2V0ZGF0YVxuXHRcdFx0XHR2YXIgSlNPTmRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhKVxuXHRcdFx0fVxuXG5cdFx0XHRlbGVtZW50LmNzcyh7XG5cdFx0XHRcdHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuXHRcdFx0XHRjdXJzb3I6ICdwb2ludGVyJ1xuXHRcdFx0fSlcblxuXHRcdFx0ZWxlbWVudFswXS5kcmFnZ2FibGUgPSB0cnVlXG5cblx0XHRcdGVsZW1lbnQuYmluZCgnZHJhZ3N0YXJ0JywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdHN0YXJ0WCA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQucGFnZVggLSBuZXdYXG5cdFx0XHRcdHN0YXJ0WSA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQucGFnZVkgLSBuZXdZXG5cdFx0XHRcdGlmIChkYXRhKSB7XG5cdFx0XHRcdFx0ZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhVHJhbnNmZXIuc2V0RGF0YSgnYXV0bycsIEpTT05kYXRhKVxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXG5cdFx0XHRlbGVtZW50LmJpbmQoJ2RyYWcnLCBmdW5jdGlvbiAoZXZlbnQpIHtcblxuXHRcdFx0XHRpZiAoZXZlbnQub3JpZ2luYWxFdmVudC5wYWdlWCA9PT0gMCkge1xuXHRcdFx0XHRcdC8vIElmIHRoaXMgaXNuJ3QgaGVyZSwgcGFnZVggd2lsbCByZXNldCB0byAwIHVwb24gZW5kIG9mIGRyYWdcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdG5ld1ggPSBldmVudC5vcmlnaW5hbEV2ZW50LnBhZ2VYIC0gc3RhcnRYXG5cdFx0XHRcdG5ld1kgPSBldmVudC5vcmlnaW5hbEV2ZW50LnBhZ2VZIC0gc3RhcnRZXG5cdFx0XHR9KVxuXG5cdFx0XHRlbGVtZW50LmJpbmQoJ2RyYWdlbmQnLCBmdW5jdGlvbiAoZXZlbnQpe1xuXHRcdFx0XHRcblx0XHRcdFx0ZWxlbWVudC5jc3Moe1xuXHRcdFx0XHRcdGxlZnQ6IG5ld1ggKyAncHgnLFxuXHRcdFx0XHRcdHRvcDogbmV3WSArICdweCdcblx0XHRcdFx0fSlcblx0XHRcdH0pXG5cdFx0fSxcblx0XHRzY29wZToge1xuXHRcdFx0ZnNhZGF0YTogJ0AnXG5cdFx0fVxuXHR9XG5cbn0pXG5cbmFwcC5kaXJlY3RpdmUoJ2ZzYXJlc2l6ZWFibGUnLCBbJyRkb2N1bWVudCcsIGZ1bmN0aW9uICgkZG9jdW1lbnQpIHtcblx0cmV0dXJuIHtcblx0XHRsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG5cdFx0XHR2YXIgdG9wQm9yZGVyLCBsZWZ0Qm9yZGVyLCByaWdodEJvcmRlciwgYm90dG9tQm9yZGVyXG5cdFx0XHR2YXIgYm9yZGVyV2lkdGggPSAxMFxuXG5cdFx0XHRlbGVtZW50LmNzcyh7XG5cdFx0XHRcdHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuXHRcdFx0XHQvLyBjdXJzb3I6ICdwb2ludGVyJ1xuXHRcdFx0fSlcblxuXHRcdFx0ZWxlbWVudC5vbignbW91c2Vtb3ZlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cblx0XHRcdFx0dmFyIHRvcEJvcmRlciA9IGVsZW1lbnRbMF0ub2Zmc2V0VG9wXG5cdFx0XHRcdHZhciBsZWZ0Qm9yZGVyID0gZWxlbWVudFswXS5vZmZzZXRMZWZ0XG5cdFx0XHRcdHZhciByaWdodEJvcmRlciA9IGVsZW1lbnRbMF0ub2Zmc2V0TGVmdCArIGVsZW1lbnRbMF0ub2Zmc2V0V2lkdGhcblx0XHRcdFx0dmFyIGJvdHRvbUJvcmRlciA9IGVsZW1lbnRbMF0ub2Zmc2V0VG9wICsgZWxlbWVudFswXS5vZmZzZXRIZWlnaHRcblxuXHRcdFx0XHR2YXIgb25SaWdodEJvcmRlckNoZWNrID0gZXZlbnQucGFnZVggPCByaWdodEJvcmRlciAmJiBldmVudC5wYWdlWCA+IHJpZ2h0Qm9yZGVyIC0gYm9yZGVyV2lkdGhcblx0XHRcdFx0dmFyIG9uQm90dG9tQm9yZGVyQ2hlY2sgPSBldmVudC5wYWdlWSA8IGJvdHRvbUJvcmRlciAmJiBldmVudC5wYWdlWSA+IGJvdHRvbUJvcmRlciAtIGJvcmRlcldpZHRoXG5cblxuXHRcdFx0XHRpZiAob25SaWdodEJvcmRlckNoZWNrKSB7XG5cdFx0XHRcdFx0ZWxlbWVudC5jc3Moe1xuXHRcdFx0XHRcdFx0Y3Vyc29yOiAnZS1yZXNpemUnXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fSBlbHNlIGlmIChvbkJvdHRvbUJvcmRlckNoZWNrKSB7XG5cdFx0XHRcdFx0ZWxlbWVudC5jc3Moe1xuXHRcdFx0XHRcdFx0Y3Vyc29yOiAncy1yZXNpemUnXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChvblJpZ2h0Qm9yZGVyQ2hlY2sgJiYgb25Cb3R0b21Cb3JkZXJDaGVjaykge1xuXHRcdFx0XHRcdGVsZW1lbnQuY3NzKHtcblx0XHRcdFx0XHRcdGN1cnNvcjogJ3NlLXJlc2l6ZSdcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGV2ZW50LnBhZ2VYIDwgcmlnaHRCb3JkZXIgLSBib3JkZXJXaWR0aCAmJiBldmVudC5wYWdlWSA8IGJvdHRvbUJvcmRlciAtIGJvcmRlcldpZHRoKSB7XG5cdFx0XHRcdFx0ZWxlbWVudC5jc3Moe1xuXHRcdFx0XHRcdFx0Y3Vyc29yOiAncG9pbnRlcidcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXG5cblx0XHRcdGVsZW1lbnQub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0XHQvLyBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG5cdFx0XHRcdC8vIGVsZW1lbnRbMF0uZHJhZ2dhYmxlID0gZmFsc2Vcblx0XHRcdFx0XG5cdFx0XHRcdHZhciB0b3BCb3JkZXIgPSBlbGVtZW50WzBdLm9mZnNldFRvcFxuXHRcdFx0XHR2YXIgbGVmdEJvcmRlciA9IGVsZW1lbnRbMF0ub2Zmc2V0TGVmdFxuXHRcdFx0XHR2YXIgcmlnaHRCb3JkZXIgPSBlbGVtZW50WzBdLm9mZnNldExlZnQgKyBlbGVtZW50WzBdLm9mZnNldFdpZHRoXG5cdFx0XHRcdHZhciBib3R0b21Cb3JkZXIgPSBlbGVtZW50WzBdLm9mZnNldFRvcCArIGVsZW1lbnRbMF0ub2Zmc2V0SGVpZ2h0XG5cblx0XHRcdFx0dmFyIG9uUmlnaHRCb3JkZXJDaGVjayA9IGV2ZW50LnBhZ2VYIDwgcmlnaHRCb3JkZXIgJiYgZXZlbnQucGFnZVggPiByaWdodEJvcmRlciAtIGJvcmRlcldpZHRoXG5cdFx0XHRcdHZhciBvbkJvdHRvbUJvcmRlckNoZWNrID0gZXZlbnQucGFnZVkgPCBib3R0b21Cb3JkZXIgJiYgZXZlbnQucGFnZVkgPiBib3R0b21Cb3JkZXIgLSBib3JkZXJXaWR0aFxuXG5cdFx0XHRcdGlmIChvblJpZ2h0Qm9yZGVyQ2hlY2sgJiYgb25Cb3R0b21Cb3JkZXJDaGVjaykge1xuXHRcdFx0XHRcdGVsZW1lbnRbMF0uZHJhZ2dhYmxlID0gZmFsc2Vcblx0XHRcdFx0XHQkZG9jdW1lbnQub24oJ21vdXNlbW92ZScsIGFkanVzdFdpZHRoSGVpZ2h0KVxuXHRcdFx0XHRcdCRkb2N1bWVudC5vbignbW91c2V1cCcsIGFkanVzdE1vdXNlVXApXG5cblx0XHRcdFx0fVx0XHRcblxuXHRcdFx0XHRpZiAob25SaWdodEJvcmRlckNoZWNrKSB7XG5cdFx0XHRcdFx0ZWxlbWVudFswXS5kcmFnZ2FibGUgPSBmYWxzZVxuXHRcdFx0XHRcdCRkb2N1bWVudC5vbignbW91c2Vtb3ZlJywgYWRqdXN0V2lkdGgpXG5cdFx0XHRcdFx0JGRvY3VtZW50Lm9uKCdtb3VzZXVwJywgYWRqdXN0TW91c2VVcClcblx0XHRcdFx0XHRcblx0XHRcdFx0fVx0XG5cblx0XHRcdFx0aWYgKG9uQm90dG9tQm9yZGVyQ2hlY2spIHtcblx0XHRcdFx0XHRlbGVtZW50WzBdLmRyYWdnYWJsZSA9IGZhbHNlXG5cdFx0XHRcdFx0JGRvY3VtZW50Lm9uKCdtb3VzZW1vdmUnLCBhZGp1c3RIZWlnaHQpXG5cdFx0XHRcdFx0JGRvY3VtZW50Lm9uKCdtb3VzZXVwJywgYWRqdXN0TW91c2VVcClcblx0XHRcdFx0XHRcblx0XHRcdFx0fVxuXG5cdFx0XHR9KVxuXG5cdFx0XHRlbGVtZW50Lm9uKCdtb3VzZXVwJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdC8vIGV2ZW50LnByZXZlbnREZWZhdWx0KClcblx0XHRcdFx0ZWxlbWVudFswXS5kcmFnZ2FibGUgPSB0cnVlXG5cdFx0XHR9KVxuXG5cdFx0XHRmdW5jdGlvbiBhZGp1c3RIZWlnaHQgKCkge1xuXHRcdFx0XHR2YXIgbmV3SGVpZ2h0ID0gZXZlbnQucGFnZVkgLSBlbGVtZW50WzBdLm9mZnNldFRvcFxuXG5cdFx0XHRcdGlmIChuZXdIZWlnaHQgPCBib3JkZXJXaWR0aCkge1xuXHRcdFx0XHRcdG5ld0hlaWdodCA9IGJvcmRlcldpZHRoXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRib3R0b21Cb3JkZXIgPSBldmVudC5wYWdlWVxuXG5cdFx0XHRcdGVsZW1lbnQuY3NzKHtcblx0XHRcdFx0XHRoZWlnaHQ6IG5ld0hlaWdodCArICdweCcsXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cblx0XHRcdGZ1bmN0aW9uIGFkanVzdFdpZHRoICgpIHtcblx0XHRcdFx0dmFyIG5ld1dpZHRoID0gZXZlbnQucGFnZVggLSBlbGVtZW50WzBdLm9mZnNldExlZnRcblxuXHRcdFx0XHRpZiAobmV3V2lkdGggPCBib3JkZXJXaWR0aCkge1xuXHRcdFx0XHRcdG5ld1dpZHRoID0gYm9yZGVyV2lkdGhcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJpZ2h0Qm9yZGVyID0gZXZlbnQucGFnZVhcblxuXHRcdFx0XHRlbGVtZW50LmNzcyh7XG5cdFx0XHRcdFx0d2lkdGg6IG5ld1dpZHRoICsgJ3B4Jyxcblx0XHRcdFx0fSlcblx0XHRcdH1cblxuXHRcdFx0ZnVuY3Rpb24gYWRqdXN0V2lkdGhIZWlnaHQgKCkge1xuXHRcdFx0XHR2YXIgbmV3SGVpZ2h0ID0gZXZlbnQucGFnZVkgLSBlbGVtZW50WzBdLm9mZnNldFRvcFxuXHRcdFx0XHR2YXIgbmV3V2lkdGggPSBldmVudC5wYWdlWCAtIGVsZW1lbnRbMF0ub2Zmc2V0TGVmdFxuXG5cdFx0XHRcdGlmIChuZXdIZWlnaHQgPCBib3JkZXJXaWR0aCkge1xuXHRcdFx0XHRcdG5ld0hlaWdodCA9IGJvcmRlcldpZHRoXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAobmV3V2lkdGggPCBib3JkZXJXaWR0aCkge1xuXHRcdFx0XHRcdG5ld1dpZHRoID0gYm9yZGVyV2lkdGhcblx0XHRcdFx0fVxuXHRcdFx0XHQgXG5cdFx0XHRcdGJvdHRvbUJvcmRlciA9IGV2ZW50LnBhZ2VZXG5cdFx0XHRcdHJpZ2h0Qm9yZGVyID0gZXZlbnQucGFnZVhcblx0XHRcdFx0ZWxlbWVudC5jc3Moe1xuXHRcdFx0XHRcdGhlaWdodDogbmV3SGVpZ2h0ICsgJ3B4Jyxcblx0XHRcdFx0XHR3aWR0aDogbmV3V2lkdGggKyAncHgnXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cblx0XHRcdGZ1bmN0aW9uIGFkanVzdE1vdXNlVXAgKCkge1xuXHRcdFx0XHRlbGVtZW50WzBdLmRyYWdnYWJsZSA9IHRydWVcblx0XHRcdFx0JGRvY3VtZW50Lm9mZignbW91c2Vtb3ZlJywgYWRqdXN0V2lkdGhIZWlnaHQpXG5cdFx0XHRcdCRkb2N1bWVudC5vZmYoJ21vdXNlbW92ZScsIGFkanVzdFdpZHRoKVxuXHRcdFx0XHQkZG9jdW1lbnQub2ZmKCdtb3VzZW1vdmUnLCBhZGp1c3RIZWlnaHQpXG5cdFx0XHRcdCRkb2N1bWVudC5vZmYoJ21vdXNldXAnLCBhZGp1c3RNb3VzZVVwKTtcblx0XHRcdH1cblxuXHRcdH1cblx0fVxufV0pXG5cbmFwcC5kaXJlY3RpdmUoJ2ZzYWNvbnRhaW5lcicsIFsnJGRvY3VtZW50JywgZnVuY3Rpb24gKCRkb2N1bWVudCkge1xuXHRyZXR1cm4ge1xuXHRcdGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblx0XHRcdHZhciBkYXRhXG5cblx0XHRcdHNjb3BlLmZzYWdldGRhdGEgPSAnZnNhZ2V0ZGF0YScgaW4gYXR0cnNcblx0XHRcdGlmICghIXNjb3BlLmZzYWdldGRhdGEpIHtcblx0XHRcdFx0YXR0cnMuZnNhZ2V0ZGF0YSA9IFtdXG5cdFx0XHR9ICAgICAgICAgXHRcblxuXHRcdFx0ZWxlbWVudC5iaW5kKCdkcmFnb3ZlcicsIGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICBcdH0pO1xuXG4gICAgICAgICBcdGVsZW1lbnQuYmluZCgnZHJvcCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgXHRcdGNvbnNvbGUubG9nKGV2ZW50Lm9yaWdpbmFsRXZlbnQudGFyZ2V0KVxuICAgICAgICAgXHRcdGlmIChldmVudC5vcmlnaW5hbEV2ZW50LmRhdGFUcmFuc2Zlci5nZXREYXRhKFwiYXV0b1wiKSA9PT0gJycpIHtcbiAgICAgICAgIFx0XHRcdHJldHVybiBcbiAgICAgICAgIFx0XHR9ICAgICAgICAgXHRcdFxuICAgICAgICAgXHRcdGRhdGEgPSBKU09OLnBhcnNlKEpTT04ucGFyc2UoZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhVHJhbnNmZXIuZ2V0RGF0YShcImF1dG9cIikpKVxuICAgICAgICAgXHRcdFxuICAgICAgICAgXHRcdGlmICghIXNjb3BlLmZzYWdldGRhdGEpIHtcblx0XHRcdFx0XHRhdHRycy5mc2FnZXRkYXRhLnB1c2goZGF0YSlcblx0XHRcdFx0fVx0XG4gICAgICAgICBcdH0pXG5cdFx0fVxuXHR9XG59XSlcbiIsImFwcC5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJHRpbWVvdXQsICRodHRwKSB7XG4gIFxuICAkc2NvcGUubXNnRnJvbVNjb3BlID0gXCIuLi5BbmQgSSdtIGEgbWVzc2FnZSBmcm9tIHRoZSBIb21lQ29udHJvbGxlciBzY29wZSwganVzdCBzbyB5b3Uga25vdyB0aGF0IEkgd29yayFcIjtcblxuICAkc2NvcGUuY29udHJvbGxlcmRhdGEgPSB7XG4gICAgdGVzdDogJ3Rlc3Qgb2JqZWN0IGZyb20gaG9tZSBjb250cm9sbGVyJ1xuICB9XG5cbn0pO1xuXG5hcHAuY29udHJvbGxlcignc2Vjb25kQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICR0aW1lb3V0LCAkaHR0cCwgJGF0dHJzKSB7XG5cbiAgJHNjb3BlLmxvZ2RhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29uc29sZS5sb2coJ2Zyb20gdGhlIHNlY29uZCBjb250cm9sbGVyJywgJGF0dHJzLmZzYWdldGRhdGEpXG4gIH1cbiAgdmFyIG15UmVjZWl2ZWREYXRhID0gJGF0dHJzLmZzYWNvbnRhaW5lclxuICBcbn0pIiwiYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgdXJsOiAnLycsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9ob21lL2hvbWUuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcidcbiAgICB9KTtcbn0pOyIsImFwcC5jb250cm9sbGVyKCdNb2R1bGVzQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIE1vZHVsZXNGYWN0b3J5KSB7XG4gIFxuICAkc2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24gKCkge1xuICAgIHZhciBkZWZhdWx0TWVzc2FnZSA9ICdJZiB5b3UgZG9uXFwndCBzZWUgYSBsaXN0IG9mIGxpbmtzIGhlcmUsIHlvdSBuZWVkIHRvIHNlZWQgeW91ciBkYXRhYmFzZSFcXG5JbiB5b3VyIHRlcm1pbmFsLCBnbyB0byB0aGlzIGFwcFxcJ3MgZGlyZWN0b3J5IGFuZCBydW4gYGd1bHAgc2VlZERCYC5cXG5UaGVuIHRyeSB0aGlzIHBhZ2UgYWdhaW4uJztcblxuICAgIE1vZHVsZXNGYWN0b3J5LmdldE5vZGVNb2R1bGVzKClcbiAgICAgIC50aGVuKGZ1bmN0aW9uKG1vZHVsZXMpIHtcbiAgICAgICAgJHNjb3BlLm5vZGVNb2R1bGVzID0gbW9kdWxlcztcbiAgICAgICAgXG4gICAgICAgIGlmICghJHNjb3BlLm5vZGVNb2R1bGVzLmxlbmd0aCkge1xuICAgICAgICAgICRzY29wZS5kZWZhdWx0TWVzc2FnZSA9IGRlZmF1bHRNZXNzYWdlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfSk7XG59KTsiLCJhcHAuZmFjdG9yeSgnTW9kdWxlc0ZhY3RvcnknLCBmdW5jdGlvbigkaHR0cCkge1xuICByZXR1cm4ge1xuICAgIGdldE5vZGVNb2R1bGVzOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvbW9kdWxlcy8nKVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmRhdGE7XG4gICAgICAgIH0pOyAgICBcbiAgICB9XG4gIH07XG59KTsiLCJhcHAuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdtb2R1bGVzJywge1xuICAgICAgICB1cmw6ICcvbW9kdWxlcycsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9tb2R1bGVzL21vZHVsZXMuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdNb2R1bGVzQ29udHJvbGxlcidcbiAgICB9KTtcbn0pOyIsImFwcC5kaXJlY3RpdmUoXCJuYXZiYXJcIiwgZnVuY3Rpb24oKXtcblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdDogXCJFXCIsXG5cdFx0dGVtcGxhdGVVcmw6IFwiL2FwcC9uYXZiYXIvbmF2YmFyLmh0bWxcIlxuXHR9O1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9